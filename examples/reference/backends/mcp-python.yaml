# Example backend configuration for MCP (Model Context Protocol) server
# This demonstrates spawning a Python-based MCP server as a subprocess
# Usage: Reference this file in your looms.yaml agent configuration

apiVersion: loom/v1
kind: Backend
name: mcp-python-backend
type: mcp
description: MCP backend for Python-based tools (filesystem, web scraping, etc.)

# MCP configuration for subprocess spawning
mcp:
  # Command to execute (e.g., python3, node, npx)
  command: python3

  # Command arguments
  args:
    - -m
    - mcp_server.main

  # Environment variables for the subprocess
  env:
    PYTHONPATH: ./mcp_servers/python
    LOG_LEVEL: info

  # Transport type: "stdio" (recommended for local servers)
  # Other options: "http" (legacy), "sse" (legacy), "streamable-http" (modern remote)
  transport: stdio

  # Enable this server (default: false for safety)
  # Set to true to activate this MCP server
  enabled: true

  # Working directory for the subprocess (optional)
  working_dir: ./mcp_servers/python

# MCP backends automatically support these capabilities
capabilities:
  query_execution: false
  schema_discovery: false
  metadata: true
  resource_listing: true
  custom_operations: true

# Notes:
# - stdio transport uses stdin/stdout for JSON-RPC communication
# - Best for local servers that run as subprocesses
# - Provides process isolation and automatic lifecycle management
# - The MCP server must implement the Model Context Protocol specification
# - Tools are discovered automatically via MCP's tools/list endpoint
# - Each tool becomes available as a backend operation
#
# Transport Options:
# - stdio: Local subprocess communication (recommended for local servers)
# - streamable-http: Remote HTTP servers with sessions (recommended for remote)
# - http/sse: Legacy remote transports (deprecated, use streamable-http)
#
# For remote servers:
# - Use streamable-http transport (see mcp-streamable-http.yaml)
# - Remove command/args/env/working_dir fields
# - Add url, enabled, enable_sessions, enable_resumption fields

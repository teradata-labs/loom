# Example backend configuration for HTTP-based MCP server
# This demonstrates connecting to a remote MCP server via HTTP/SSE
#
# ⚠️  DEPRECATED: This transport is legacy (pre-2025 MCP spec)
# For new deployments, use streamable-http transport instead
# See: mcp-streamable-http.yaml
#
# Usage: Reference this file in your looms.yaml agent configuration

apiVersion: loom/v1
kind: Backend
name: mcp-http-backend
type: mcp
description: MCP backend for remote HTTP-based tools (legacy transport)

# MCP configuration for HTTP/SSE transport (legacy)
mcp:
  # Transport type: "http" or "sse" for server-sent events
  # Note: These are legacy transports, use "streamable-http" for new servers
  transport: http

  # URL endpoint for the MCP server
  url: http://localhost:8080/mcp

  # Enable this server (default: false for safety)
  # Set to true to activate this MCP server
  enabled: true

  # Note: command, args, env, and working_dir are not used for HTTP transport

# MCP backends automatically support these capabilities
capabilities:
  query_execution: false
  schema_discovery: false
  metadata: true
  resource_listing: true
  custom_operations: true

# Notes:
# - HTTP/SSE transport connects to an already-running MCP server
# - The MCP server must implement the Model Context Protocol specification
# - Tools are discovered automatically via MCP's tools/list endpoint
# - Each tool becomes available as a backend operation
# - Consider using stdio transport for better process isolation
#
# ⚠️  Migration to Streamable-HTTP:
# - Legacy HTTP/SSE transports are deprecated (pre-2025 MCP spec)
# - For new deployments, use "streamable-http" transport instead
# - Streamable-HTTP provides:
#   * Session management (Mcp-Session-Id headers)
#   * Stream resumption (fault tolerance)
#   * Single unified endpoint
#   * Better error handling
# - To migrate: Change transport: "http" → transport: "streamable-http"
#   and add enable_sessions: true
#
# Backwards Compatibility:
# - This transport remains supported for existing servers
# - No breaking changes to existing configurations
# - Servers must explicitly set enabled: true to start

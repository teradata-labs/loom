---
name: memory_tools
namespace: loom
---
prompts:
  - id: conversation_memory_description
    content: |
      Access conversation history from long-term storage.

      Three actions available:
      1. recall - Retrieve specific messages by offset/limit from current session
      2. search - Search for relevant messages using natural language queries (supports session scopes)
      3. clear - Remove recalled messages from context to free token budget

      Use this when:
      - User references earlier discussions no longer in recent context
      - Need to find specific topics across conversation history
      - Token budget is tight and old context needs clearing

      Examples:

      Recall old messages:
        conversation_memory(action="recall", offset=0, limit=10)

      Search current session:
        conversation_memory(action="search", query="SQL performance", session_scope="current")

      Search all agent sessions:
        conversation_memory(action="search", query="database optimization", session_scope="agent", limit=5)

      Clear recalled context:
        conversation_memory(action="clear")

      Session scopes:
      - "current" (default): Search only this conversation session
      - "agent": Search all sessions for this agent
      - "all": Search across all sessions (requires permissions)

      The search action uses BM25 + LLM semantic reranking to find conceptually relevant messages, even with different terminology.
    variables: {}
    tags:
      - tools
      - memory
      - unified
      - search
      - recall
    metadata:
      version: "v1.0"
      description: "Unified conversation memory tool description"

  - id: session_memory_description
    content: |
      Manage sessions and access cross-session memory.

      Three actions available:
      1. list - List all sessions for the current agent with metadata
      2. summary - Retrieve L2 memory summaries (compacted conversation history) for a session
      3. compact - Manually trigger memory compaction for current session

      Use this when:
      - User asks about past sessions or conversations
      - Need to view summarized conversation history
      - Want to free up token budget by compacting current session
      - Exploring conversation history across multiple sessions

      Examples:

      List recent sessions:
        session_memory(action="list", limit=10)

      Get session summary:
        session_memory(action="summary", session_id="session-abc-123")

      Compact current session to free memory:
        session_memory(action="compact")

      Force compaction even if not needed:
        session_memory(action="compact", force=true)

      L2 summaries are automatically generated when conversations grow long, preserving key context while reducing token usage. Use summary action to review historical conversation summaries from past sessions.
    variables: {}
    tags:
      - tools
      - memory
      - unified
      - sessions
      - compaction
    metadata:
      version: "v1.0"
      description: "Unified session memory tool description"
